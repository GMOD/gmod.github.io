<div id="mw-page-base" class="noprint">

</div>

<div id="mw-head-base" class="noprint">

</div>

<div id="content" class="mw-body" role="main">

<span id="top"></span>

<div id="mw-js-message" style="display:none;">

</div>

<div id="siteNotice">

<div id="localNotice" lang="en" dir="ltr">

<span style="color:red; background-color:lightblue;font-size=30px">NOTE:
We are working on migrating this site away from MediaWiki, so editing
pages will be disabled for now.</span>

</div>

</div>

# <span dir="auto">Chado Audit Module</span>

<div id="bodyContent">

<div id="siteSub">

From GMOD

</div>

<div id="contentSub">

</div>

<div id="jump-to-nav" class="mw-jump">

Jump to: [navigation](#mw-navigation), [search](#p-search)

</div>

<div id="mw-content-text" class="mw-content-ltr" lang="en" dir="ltr">

<div id="toc" class="toc">

<div id="toctitle">

## Contents

</div>

- [<span class="tocnumber">1</span>
  <span class="toctext">Introduction</span>](#Introduction)
  - [<span class="tocnumber">1.1</span> <span class="toctext">Audit
    Policy</span>](#Audit_Policy)
  - [<span class="tocnumber">1.2</span>
    <span class="toctext">Transaction Use
    Cases</span>](#Transaction_Use_Cases)
    - [<span class="tocnumber">1.2.1</span>
      <span class="toctext">Insertion of a New
      Record</span>](#Insertion_of_a_New_Record)
    - [<span class="tocnumber">1.2.2</span> <span class="toctext">Update
      of an Existing Record</span>](#Update_of_an_Existing_Record)
    - [<span class="tocnumber">1.2.3</span>
      <span class="toctext">Deletion of an Existing
      Record</span>](#Deletion_of_an_Existing_Record)
  - [<span class="tocnumber">1.3</span>
    <span class="toctext">Implementation
    Issues</span>](#Implementation_Issues)
  - [<span class="tocnumber">1.4</span> <span class="toctext">Listing of
    MODs' Implemented Audit Tracking
    Systems</span>](#Listing_of_MODs.27_Implemented_Audit_Tracking_Systems)

</div>

## <span id="Introduction" class="mw-headline">Introduction</span>

The Audit module is not a module in the same sense as the other Chado
modules. It is a set of recommendations on how one might implement audit
trail logging in Chado. This documentation describes an example of such
an implementation which is in use at
<a href="http://flybase.org" class="external text"
rel="nofollow">FlyBase</a>. The SQL used at Flybase is
`chado/modules/audit/audit_tables.sql`.

  

### <span id="Audit_Policy" class="mw-headline">Audit Policy</span>

We consider the implementation of auditing policy as a database
administration issue and subject to the local requirements of specific
database groups. We therefore have not developed a detailed audit
module, providing instead this policy statement.

Database project groups who would use chado as their primary DBMS would
be well advised to implement as robust and detailed an audit trail as
possible, while groups who would use chado more informally, for instance
primarily as a read-only resource, may have no need for auditing.

We here describe how auditing will be implemented at FlyBase, where
chado will serve as the primary DBMS.

Auditing will be implemented in a separate, orthogonal database to the
chado, with each chado table having a corresponding shadow audit table
which will include all of the columns of the chado table, plus these
additional columns:

<div class="mw-geshi mw-code mw-content-ltr" dir="ltr">

<div class="sql source-sql">

``` de1
    transaction_date TIMESTAMP NOT NULL
    transaction_type CHAR NOT NULL
```

</div>

</div>

Where *transaction_type* value is one of:

- i (insertion)
- u (update)
- d (deletion)

  
Thus an chado db instance chado.1 containing a table *gene*, for
example:

<div class="mw-geshi mw-code mw-content-ltr" dir="ltr">

<div class="sql source-sql">

``` de1
    CREATE TABLE gene (
           gene_id serial NOT NULL,
           PRIMARY KEY (gene_id),
           name VARCHAR(255) NOT NULL,
           dbxref_id INT,
           FOREIGN KEY (dbxref_id) REFERENCES dbxref(dbxref_id),
           UNIQUE(name),
           UNIQUE(dbxref_id)
    );
```

</div>

</div>

Would have a corresponding audit database, chado.1_audit, containing a
shadow audit table, *gene_audit*:

<div class="mw-geshi mw-code mw-content-ltr" dir="ltr">

<div class="sql source-sql">

``` de1
    CREATE TABLE gene_audit (
           gene_id serial NOT NULL,
           PRIMARY KEY (gene_id),
           name VARCHAR(255) NOT NULL,
           dbxref_id INT,
               FOREIGN KEY (dbxref_id) REFERENCES dbxref(dbxref_id),
               UNIQUE(name),
               UNIQUE(dbxref_id),
               transaction_date TIMESTAMP NOT NULL,
               transaction_type CHAR NOT NULL
    );
```

</div>

</div>

  

### <span id="Transaction_Use_Cases" class="mw-headline">Transaction Use Cases</span>

#### <span id="Insertion_of_a_New_Record" class="mw-headline">Insertion of a New Record</span>

When a record is intially inserted into an chado table, the same record
is inserted into the corresponding shadow audit table, with the current
timestamp and *transaction_type* = 'i'.

#### <span id="Update_of_an_Existing_Record" class="mw-headline">Update of an Existing Record</span>

When a record is to be updated, before the update transaction is
executed in chado, the existing chado record is copied to the
corresponding shadow audit table, with the current timestamp and
*transaction_type* = 'u'. The update transaction is then executed in
chado.

#### <span id="Deletion_of_an_Existing_Record" class="mw-headline">Deletion of an Existing Record</span>

When a record is to be deleted, before the delete trasaction is executed
in chado, the existing chado record is copied to the corresponding
shadow audit table, with the corrent timestamp and *transaction_type* =
'd'. The delete transaction is then executed in chado.

  

### <span id="Implementation_Issues" class="mw-headline">Implementation Issues</span>

The benefit of this system is that it allows a certain amount of "time
travel", or the ability to reconstruct the database to its state at a
particular time in the past. We don't anticipate making this
functionality available to the general user population, but recognize
that from a database programming point of view, it is often quite
useful, and sometimes vital, for a programmer to be able to track
changes in the database in detail.

While the auditing policy described here fulfills all of our auditing
requirements in principle, it remains to be seen how it will work in
practice. The size of the shadow audit database may become an issue over
time. How the handling of audit transactions will affect overall
database transaction performance is also unknown. FlyBase makes a
practice of reporting certain audit details to the public (e.g. date
entered and date last updated of gene records) - it is not know whether
implementing this will be too expensive using this shadow audit db
method

### <span id="Listing_of_MODs.27_Implemented_Audit_Tracking_Systems" class="mw-headline">Listing of MODs' Implemented Audit Tracking Systems</span>

A listing of instances of audit tracking systems implemented by
different MODs is provided
[here](Audit_tracking_by_mods "Audit tracking by mods").

</div>

<div class="printfooter">

Retrieved from
"<http://gmod.org/mediawiki/index.php?title=Chado_Audit_Module&oldid=26555>"

</div>

<div id="catlinks" class="catlinks">

<div id="mw-normal-catlinks" class="mw-normal-catlinks">

[Categories](Special:Categories "Special:Categories"):

- [Chado Modules](Category:Chado_Modules "Category:Chado Modules")
- [!Lacking ERD](Category:!Lacking_ERD "Category:!Lacking ERD")

</div>

</div>

<div class="visualClear">

</div>

</div>

</div>

<div id="mw-navigation">

## Navigation menu

<div id="mw-head">

<div id="p-personal" role="navigation"
aria-labelledby="p-personal-label">

### Personal tools

- <span id="pt-login"><a
  href="http://gmod.org/mediawiki/index.php?title=Special:UserLogin&amp;returnto=Chado+Audit+Module"
  accesskey="o"
  title="You are encouraged to log in; however, it is not mandatory [o]">Log
  in / create account</a></span>

</div>

<div id="left-navigation">

<div id="p-namespaces" class="vectorTabs" role="navigation"
aria-labelledby="p-namespaces-label">

### Namespaces

- <span id="ca-nstab-main"><a href="Chado_Audit_Module" accesskey="c"
  title="View the content page [c]">Page</a></span>
- <span id="ca-talk"><a
  href="http://gmod.org/mediawiki/index.php?title=Talk:Chado_Audit_Module&amp;action=edit&amp;redlink=1"
  accesskey="t"
  title="Discussion about the content page [t]">Discussion</a></span>

</div>

<div id="p-variants" class="vectorMenu emptyPortlet" role="navigation"
aria-labelledby="p-variants-label">

### 

### Variants[](#)

<div class="menu">

</div>

</div>

</div>

<div id="right-navigation">

<div id="p-views" class="vectorTabs" role="navigation"
aria-labelledby="p-views-label">

### Views

- <span id="ca-view">[Read](Chado_Audit_Module)</span>
- <span id="ca-viewsource"><a
  href="http://gmod.org/mediawiki/index.php?title=Chado_Audit_Module&amp;action=edit"
  accesskey="e" title="This page is protected.
  You can view its source [e]">View source</a></span>
- <span id="ca-history"><a
  href="http://gmod.org/mediawiki/index.php?title=Chado_Audit_Module&amp;action=history"
  accesskey="h" title="Past revisions of this page [h]">View history</a></span>

</div>

<div id="p-cactions" class="vectorMenu emptyPortlet" role="navigation"
aria-labelledby="p-cactions-label">

### Actions[](#)

<div class="menu">

</div>

</div>

<div id="p-search" role="search">

### Search

<div id="simpleSearch">

</div>

</div>

</div>

</div>

<div id="mw-panel">

<div id="p-logo" role="banner">

<a href="Main_Page"
style="background-image: url(../images/GMOD-cogs.png);"
title="Visit the main page"></a>

</div>

<div id="p-Navigation" class="portal" role="navigation"
aria-labelledby="p-Navigation-label">

### Navigation

<div class="body">

- <span id="n-GMOD-Home">[GMOD Home](Main_Page)</span>
- <span id="n-Software">[Software](GMOD_Components)</span>
- <span id="n-Categories-.2F-Tags">[Categories /
  Tags](Categories)</span>
- <span id="n-View-all-pages">[View all pages](Special:AllPages)</span>

</div>

</div>

<div id="p-Documentation" class="portal" role="navigation"
aria-labelledby="p-Documentation-label">

### Documentation

<div class="body">

- <span id="n-Overview">[Overview](Overview)</span>
- <span id="n-FAQs">[FAQs](Category:FAQ)</span>
- <span id="n-HOWTOs">[HOWTOs](Category:HOWTO)</span>
- <span id="n-Glossary">[Glossary](Glossary)</span>

</div>

</div>

<div id="p-Community" class="portal" role="navigation"
aria-labelledby="p-Community-label">

### Community

<div class="body">

- <span id="n-GMOD-News">[GMOD News](GMOD_News)</span>
- <span id="n-Training-.2F-Outreach">[Training /
  Outreach](Training_and_Outreach)</span>
- <span id="n-Support">[Support](Support)</span>
- <span id="n-GMOD-Promotion">[GMOD Promotion](GMOD_Promotion)</span>
- <span id="n-Meetings">[Meetings](Meetings)</span>
- <span id="n-Calendar">[Calendar](Calendar)</span>

</div>

</div>

<div id="p-tb" class="portal" role="navigation"
aria-labelledby="p-tb-label">

### Tools

<div class="body">

- <span id="t-whatlinkshere"><a href="Special:WhatLinksHere/Chado_Audit_Module" accesskey="j"
  title="A list of all wiki pages that link here [j]">What links here</a></span>
- <span id="t-recentchangeslinked"><a href="Special:RecentChangesLinked/Chado_Audit_Module" accesskey="k"
  title="Recent changes in pages linked from this page [k]">Related
  changes</a></span>
- <span id="t-specialpages"><a href="Special:SpecialPages" accesskey="q"
  title="A list of all special pages [q]">Special pages</a></span>
- <span id="t-print"><a
  href="http://gmod.org/mediawiki/index.php?title=Chado_Audit_Module&amp;printable=yes"
  rel="alternate" accesskey="p"
  title="Printable version of this page [p]">Printable version</a></span>
- <span id="t-permalink">[Permanent
  link](http://gmod.org/mediawiki/index.php?title=Chado_Audit_Module&oldid=26555 "Permanent link to this revision of the page")</span>
- <span id="t-info">[Page
  information](http://gmod.org/mediawiki/index.php?title=Chado_Audit_Module&action=info)</span>
- <span id="t-smwbrowselink"><a href="Special:Browse/Chado_Audit_Module" rel="smw-browse">Browse
  properties</a></span>
- <span id="t-pdf">[Print as
  PDF](http://gmod.org/mediawiki/index.php?title=Special:PdfPrint&page=Chado_Audit_Module)</span>

</div>

</div>

</div>

</div>

<div id="footer" role="contentinfo">

- <span id="footer-info-lastmod">Last updated at 04:31 on 18 February
  2015.</span>
- <span id="footer-info-viewcount">63,616 page views.</span>
- <span id="footer-info-copyright">Content is available under
  <a href="http://www.gnu.org/licenses/fdl-1.3.html" class="external"
  rel="nofollow">a GNU Free Documentation License</a> unless otherwise
  noted.</span>

<!-- -->

- <span id="footer-places-about">[About
  GMOD](GMOD:About "GMOD:About")</span>

<!-- -->

- <span id="footer-copyrightico">[<img src="http://www.gnu.org/graphics/gfdl-logo-small.png" width="88"
  height="31" alt="a GNU Free Documentation License" />](http://www.gnu.org/licenses/fdl-1.3.html)</span>
- <span id="footer-poweredbyico">[<img
  src="../mediawiki/skins/common/images/poweredby_mediawiki_88x31.png"
  width="88" height="31" alt="Powered by MediaWiki" />](http://www.mediawiki.org/)
  [<img
  src="../mediawiki/extensions/SemanticMediaWiki/resources/images/smw_button.png"
  width="88" height="31" alt="Powered by Semantic MediaWiki" />](https://www.semantic-mediawiki.org/wiki/Semantic_MediaWiki)</span>

<div style="clear:both">

</div>

</div>
